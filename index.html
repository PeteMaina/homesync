<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Home Sync — Landlord Dashboard</title>

  <!-- font (single external request for premium look) -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    /* ===========================
       Base / Reset
       =========================== */
    :root{
      --green: #00B894;
      --blue:  #0984E3;
      --bg:    #f6f8fb;
      --card-tint: rgba(255,255,255,0.55); /* frosted white card */
      --card-border: rgba(255,255,255,0.6);
      --muted: #64748b;
      --text: #0f1724;
      --glass-shadow-1: rgba(255,255,255,0.6);
      --glass-shadow-2: rgba(15,23,36,0.12);
      --accent-gradient: linear-gradient(90deg,var(--green),var(--blue));
      --radius-lg: 20px;
    }

    * { box-sizing: border-box; margin:0; padding:0; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; }
    html,body { height:100%; }
    body {
      font-family: "Poppins", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: var(--bg);
      color: var(--text);
      display:flex;
      min-height:100vh;
      overflow:hidden;
    }

    /* ===========================
       Layout: Sidebar + Main
       =========================== */
    .app {
      display:flex;
      width:100%;
      height:100vh;
      align-items:stretch;
    }

    /* Sidebar */
    .sidebar {
      width:240px;
      min-width: 220px;
      background: linear-gradient(180deg,#0b1a1f 0%, #071017 100%); /* deep charcoal */
      color: #ffffff;
      padding: 28px 18px;
      display:flex;
      flex-direction:column;
      gap: 18px;
      transition: transform .32s ease, width .25s ease;
      z-index: 60;
    }
    .sidebar .brand {
      display:flex; align-items:center; gap:12px;
    }
    .brand__icon { width:52px; height:52px; object-fit:contain; border-radius:10px; }
    .brand__title { font-size:1.2rem; font-weight:700; letter-spacing:0.2px; }
    .brand__sub { font-size:0.85rem; color:rgba(255,255,255,0.72); margin-top:2px; }

    nav.nav {
      display:flex; flex-direction:column; gap:8px; margin-top:6px;
    }
    a.nav-link {
      display:flex; align-items:center; gap:12px; padding:10px 12px; border-radius:12px;
      color: rgba(255,255,255,0.92); text-decoration:none; font-weight:600; transition: all .18s ease;
    }
    a.nav-link img { width:28px; height:28px; opacity:0.95; }
    a.nav-link:hover { transform:translateY(-3px); box-shadow: 0 8px 20px rgba(2,6,23,0.5); }
    a.nav-link.active {
      background: linear-gradient(90deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
      box-shadow: inset 0 0 0 1px rgba(255,255,255,0.04), 0 10px 30px rgba(7,10,12,0.3);
      position:relative;
    }
    /* small caption in sidebar */
    .sidebar .foot { margin-top:auto; font-size:0.82rem; color:rgba(255,255,255,0.65); }

    /* Hamburger icon for mobile */
    .hamburger {
      display:none;
      position:fixed;
      left:14px; top:14px;
      z-index:120;
      background:transparent;
      border:none;
      color:var(--green);
      padding:10px 12px;
      font-size:1.1rem;
      border-radius:10px;
      box-shadow: 0 6px 18px rgba(2,6,23,0.12);
      cursor:pointer;
    }

    /* Main area */
    .main {
      flex:1;
      padding: 28px;
      display:flex;
      flex-direction:column;
      gap:20px;
      overflow:auto;
      align-items:stretch;
    }

    /* Top header inside main (duplicate of card heading in uploaded file) */
    .header-card {
      width:100%;
      border-radius:var(--radius-lg);
      position:relative;
      overflow:visible;
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding:18px 22px;
      gap:18px;
      /* frosted glass */
      background: linear-gradient(180deg, rgba(255,255,255,0.68), rgba(255,255,255,0.62));
      border: 1px solid rgba(255,255,255,0.7);
      box-shadow: 0 10px 30px var(--glass-shadow-2), inset 0 1px 0 rgba(255,255,255,0.55);
    }

    /* subtle top-left highlight + bottom-right shadow using psuedo elements (matches your request) */
    .header-card::before,
    .header-card::after {
      content:"";
      position:absolute; pointer-events:none; border-radius:inherit;
    }
    .header-card::before {
      top:-10%; left:-12%;
      width:60%; height:55%;
      background: radial-gradient(800px 400px at -12% -20%, rgba(255,255,255,0.45), rgba(255,255,255,0.12) 40%, transparent 70%);
      filter:blur(10px);
      transform:translateZ(0);
    }
    .header-card::after {
      right:-8%; bottom:-6%;
      width:70%; height:60%;
      background: radial-gradient(800px 480px at 110% 120%, rgba(2,6,23,0.32), rgba(2,6,23,0.12) 40%, transparent 70%);
      filter:blur(8px);
    }

    /* header content originally in your file: keep brand & logout */
    .header-left { display:flex; gap:12px; align-items:center; min-width:0; }
    .brand__title-lg { font-size:clamp(1.28rem, 2.8vw, 1.9rem); font-weight:700; margin:0; color:var(--text); }
    .brand__sub-lg { font-size:0.92rem; color:var(--muted); margin-top:2px; }

    .logout {
      display:inline-flex; align-items:center; gap:12px; padding:8px 12px; border-radius:14px;
      background: transparent; border:1px solid rgba(10,20,30,0.05); cursor:pointer; text-decoration:none;
    }
    .logout img { width:44px; height:44px; display:block; border-radius:8px; }
    .logout span { font-weight:700; color:var(--text); }

    /* Grid for dashboard cards / content */
    .grid {
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap:18px;
      align-items:start;
      width:100%;
    }

    /* KPI small cards (3 across on wide, responsive) */
    .kpi {
      grid-column: span 3;
      min-height:96px;
      border-radius:16px;
      padding:14px;
      background: linear-gradient(180deg, rgba(255,255,255,0.9), rgba(255,255,255,0.85));
      border:1px solid rgba(255,255,255,0.7);
      box-shadow: 0 8px 30px rgba(2,6,23,0.06);
      display:flex; flex-direction:column; justify-content:space-between;
    }
    .kpi .k-title { color:var(--muted); font-size:0.86rem; font-weight:600; }
    .kpi .k-value { font-size:1.6rem; font-weight:700; color:var(--text); }

    /* Wide card for form & table */
    .card {
      grid-column: span 12;
      border-radius:16px;
      padding:16px;
      background: linear-gradient(180deg, rgba(255,255,255,0.92), rgba(255,255,255,0.88));
      border:1px solid rgba(10,20,30,0.04);
      box-shadow: 0 12px 40px rgba(2,6,23,0.06);
    }

    /* form layout inside card */
    .form-row { display:flex; gap:12px; align-items:center; flex-wrap:wrap; }
    .input-field {
      padding:12px 14px; border-radius:12px; border:1px solid #e6eef6; font-size:1rem;
      min-width:0; flex:1 1 240px; background:#fff;
    }
    .btn {
      background: var(--accent-gradient); color:white; border:none; padding:12px 14px; border-radius:12px; font-weight:700;
      cursor:pointer; box-shadow: 0 8px 30px rgba(3, 106, 145, 0.12);
      transition: transform .15s ease, box-shadow .15s ease;
    }
    .btn:hover { transform:translateY(-3px); box-shadow: 0 18px 48px rgba(3,106,145,0.12); }

    /* bills table */
    .table-wrap { overflow:auto; margin-top:16px; border-radius:12px; border:1px solid #eef6fb; }
    table { width:100%; border-collapse:collapse; min-width:640px; }
    thead tr { background: #f1f7fb; }
    th, td { padding:12px 14px; text-align:left; border-bottom:1px solid #f1f7fb; color:var(--text); }
    th { font-weight:700; color:var(--muted); font-size:0.92rem; }

    /* concerns & visitors smaller cards */
    .side-col { grid-column: span 4; display:flex; flex-direction:column; gap:12px; }
    .list { background:transparent; padding:12px; border-radius:12px; border:1px solid #eef6fb; }

    /* responsiveness */
    @media (max-width: 1100px) {
      .kpi { grid-column: span 4; }
      .side-col { grid-column: span 6; }
    }
    @media (max-width: 820px) {
      .sidebar { transform: translateX(-110%); position:fixed; left:0; top:0; height:100vh; width:72%; max-width:300px; }
      .hamburger { display:block; }
      .main { padding:18px; }
      .grid { gap:12px; }
      .kpi { grid-column: span 6; }
      .card { grid-column: span 12; }
      .side-col { grid-column: span 12; }
      .brand__title { font-size:1rem; }
    }
    @media (max-width:420px) {
      .kpi .k-value { font-size:1.2rem; }
      .brand__icon { width:44px; height:44px; }
      .logout img { width:40px; height:40px; }
    }

    /* subtle corner border highlight for glass elements (non-animated) */
    .corner-highlight {
      position:absolute; right:8px; top:8px; width:26px; height:26px; border-radius:6px;
      border-right: 1.5px solid rgba(255,255,255,0.85); border-top:1.5px solid rgba(255,255,255,0.85);
      mix-blend-mode:overlay; pointer-events:none;
    }

    /* small utility */
    .muted { color:var(--muted); font-size:.93rem; }
    .small { font-size:0.88rem; color:var(--muted); }
  </style>
</head>

<body>
  <button class="hamburger" id="hambBtn" aria-label="Open menu">☰</button>

  <div class="app" id="appRoot">
    <!-- Sidebar: keep all original links + icons (preserves user's images) -->
    <aside class="sidebar" id="sidebar">
      <div class="brand">
        <img src="icons/billing.png" alt="Home Sync" class="brand__icon" />
        <div>
          <div class="brand__title">Home Sync</div>
          <div class="brand__sub">Remind them their dues</div>
        </div>
      </div>

      <nav class="nav" aria-label="Main navigation">
        <a href="#" class="nav-link active" data-page="billing" onclick="switchPage(event, 'billing', this)">
          <img src="icons/home.png" alt=""><span>Billing</span>
        </a>

        <a href="tenants.html" class="nav-link" data-page="tenants" onclick="switchPage(event, 'visitors', this)">
          <img src="icons/tenants.png" alt=""><span>Tenants</span>
        </a>

        <a href="#" class="nav-link" data-page="concerns" onclick="switchPage(event, 'concerns', this)">
          <img src="icons/issues.png" alt=""><span>Concerns</span>
        </a>

        <a href="#" class="nav-link" data-page="visitors" onclick="switchPage(event, 'visitors', this)">
          <img src="icons/visitors.png" alt=""><span>Visitors</span>
        </a>

        <a href="auth.html" class="nav-link" onclick="logout(event)">
          <img src="icons/logout.png" alt=""><span>Logout</span>
        </a>
      </nav>

      <div class="foot small">© <strong>Home Sync</strong> • Billing & tenant management</div>
    </aside>

    <!-- Main content -->
    <main class="main" id="main">
      <!-- header-card replicates the uploaded header but polished -->
      <section class="header-card" aria-labelledby="dashboardTitle">
        <div class="header-left">
          <div style="display:flex; flex-direction:column;">
            <h1 id="dashboardTitle" class="brand__title-lg">Dashboard — Billing Overview</h1>
            <div class="brand__sub-lg">Quick view of water usage, outstanding bills, and visitor logs</div>
          </div>
        </div>

        <div style="display:flex; align-items:center; gap:12px;">
          <!-- keep logout block and icon -->
          <a class="logout" href="auth.html" onclick="logout(event)" title="Sign out">
            <img src="icons/logout.png" alt="Logout" />
            <span>Log out</span>
          </a>
        </div>

        <!-- corner highlight to show border corner -->
        <div class="corner-highlight" aria-hidden="true"></div>
      </section>

      <!-- Grid: KPI + main card + side columns -->
      <section class="grid" aria-live="polite">
        <!-- KPIs -->
        <div class="kpi">
          <div class="k-title">Total Collected</div>
          <div class="k-value" id="collectedValue">KES 0</div>
          <div class="small muted">This month</div>
        </div>

        <div class="kpi">
          <div class="k-title">Pending Bills</div>
          <div class="k-value" id="pendingValue">KES 0</div>
          <div class="small muted">Unsettled</div>
        </div>

        <div class="kpi">
          <div class="k-title">Visitors Today</div>
          <div class="k-value" id="visitorsValue">0</div>
          <div class="small muted">Guest logs</div>
        </div>

        <!-- Main billing card (form + table) -->
        <div class="card" id="billingCard" style="grid-column: span 8;">
          <div style="display:flex; align-items:center; justify-content:space-between; gap:12px;">
            <div>
              <h3 style="margin:0 0 6px 0">💧 Water Billing</h3>
              <div class="small muted">Create bills by entering units for each house</div>
            </div>
            <div class="small muted">Rate: <strong id="rateLabel">KES 200/unit</strong></div>
          </div>

          <div style="height:10px;"></div>

          <div class="form-row" role="form" aria-label="Add bill form">
            <input id="house" class="input-field" placeholder="e.g., House 1" aria-label="House number">
            <input id="units" class="input-field" placeholder="Units used" type="number" aria-label="Water units">
            <button class="btn" onclick="addBill()">Add Bill</button>
          </div>

          <div class="table-wrap" aria-live="polite">
            <table id="billsTable" aria-describedby="billsDesc">
              <caption id="billsDesc" class="small muted" style="text-align:left; padding:12px 16px 0;">Recorded bills (newest last)</caption>
              <thead>
                <tr><th>House</th><th>Units</th><th>Amount (KES)</th></tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>

        <!-- side column: concerns + visitors (keeps your content & images) -->
        <div style="grid-column: span 4; display:flex; flex-direction:column; gap:12px;">
          <!-- Concerns -->
          <div class="list" id="concernsCard">
            <h4 style="margin:0 0 8px 0">Tenant Concerns</h4>
            <ul id="concernsList" style="padding-left:18px; margin:0; color:var(--text);">
              <li>House 2 - Leak in bathroom</li>
              <li>House 5 - Broken lock</li>
            </ul>
          </div>

          <!-- Visitors -->
          <div class="list" id="visitorsCard">
            <h4 style="margin:0 0 8px 0">Visitor Logs</h4>
            <ul id="visitorsList" style="padding-left:18px; margin:0; color:var(--text);">
              <li>12 Feb - John visiting House 3</li>
              <li>15 Feb - Mary visiting House 6</li>
            </ul>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script>
    /***************
     * App state
     ***************/
    const ratePerUnit = 200; // kept from your file (KES per unit)
    const bills = [];        // in-memory store
    let collected = 0;
    let pending = 0;
    let visitorsCount = 2; // preserving your example logs

    // DOM refs
    const billsTbody = document.querySelector('#billsTable tbody');
    const collectedValue = document.getElementById('collectedValue');
    const pendingValue = document.getElementById('pendingValue');
    const visitorsValue = document.getElementById('visitorsValue');
    const rateLabel = document.getElementById('rateLabel');

    rateLabel.textContent = `KES ${ratePerUnit}/unit`;
    visitorsValue.textContent = visitorsCount;

    /***************
     * Navigation
     ***************/
    const sidebar = document.getElementById('sidebar');
    const hambBtn = document.getElementById('hambBtn');

    function toggleSidebar() {
      if (sidebar.style.transform && sidebar.style.transform !== '') {
        sidebar.style.transform = '';
      } else {
        sidebar.style.transform = 'translateX(0)';
      }
    }

    // show/hide for mobile: hamburger
    hambBtn.addEventListener('click', function () {
      // When opened, slide in
      if (getComputedStyle(sidebar).transform === 'none' || getComputedStyle(sidebar).transform === 'matrix(1, 0, 0, 1, 0, 0)') {
        // It appears normally on wide screens; on small screens CSS initially translates it away
        sidebar.style.transform = 'translateX(0)';
      } else {
        sidebar.style.transform = 'translateX(-110%)';
      }
      // toggle aria-pressed for accessibility
      const pressed = hambBtn.getAttribute('aria-pressed') === 'true';
      hambBtn.setAttribute('aria-pressed', String(!pressed));
    });

    // responsive: ensure sidebar resets when resizing to desktop
    window.addEventListener('resize', () => {
      if (window.innerWidth > 820) {
        sidebar.style.transform = ''; // default
      } else {
        sidebar.style.transform = 'translateX(-110%)';
      }
    });

    // startup: set sidebar state appropriate for screen
    if (window.innerWidth <= 820) sidebar.style.transform = 'translateX(-110%)';

    // page switching — keeps your pages (billing, concerns, visitors) intact and simply toggles
    function switchPage(evt, pageId, linkEl) {
      evt && evt.preventDefault();
      // pages available in DOM: billingCard (main), concernsCard, visitorsCard -> but we show/hide by scrolling into view or focusing
      // For simple SPA feel: scroll to the area and toggle active nav link
      // Manage active nav link
      document.querySelectorAll('.nav-link').forEach(n => n.classList.remove('active'));
      if (linkEl) linkEl.classList.add('active');

      // on mobile, close sidebar after click
      if (window.innerWidth <= 820) sidebar.style.transform = 'translateX(-110%)';

      // optionally focus the relevant card/section if present
      if (pageId === 'billing') {
        document.getElementById('billingCard').scrollIntoView({behavior:'smooth', block:'center'});
      } else if (pageId === 'concerns') {
        document.getElementById('concernsCard').scrollIntoView({behavior:'smooth', block:'center'});
      } else if (pageId === 'visitors') {
        document.getElementById('visitorsCard').scrollIntoView({behavior:'smooth', block:'center'});
      }
    }

    /***************
     * Billing logic (keeps your original behavior)
     ***************/
    function formatKES(n) {
      return 'KES ' + Number(n).toLocaleString();
    }

    function addBill() {
      const houseEl = document.getElementById('house');
      const unitsEl = document.getElementById('units');

      const house = houseEl.value.trim();
      const unitsRaw = unitsEl.value;
      const units = parseFloat(unitsRaw);

      if (!house || isNaN(units) || units < 0) {
        // friendly inline validation instead of alert
        flashError('Please enter a valid house and unit count.');
        return;
      }

      const amount = units * ratePerUnit;
      bills.push({ house, units, amount, created: new Date().toISOString() });

      // update table
      const tr = document.createElement('tr');
      tr.innerHTML = `<td>${escapeHtml(house)}</td><td>${units}</td><td>${amount.toLocaleString()}</td>`;
      billsTbody.appendChild(tr);

      // update KPI values
      collected += amount; // simulate collected immediately for demo
      pending += 0; // if you track pending separately you can change here
      updateKPIs();

      // reset
      houseEl.value = ''; unitsEl.value = '';
      houseEl.focus();
    }

    function updateKPIs(){
      collectedValue.textContent = formatKES(collected);
      pendingValue.textContent = formatKES(pending);
      visitorsValue.textContent = bills.length ? bills.length : visitorsCount;
    }

    function escapeHtml(str) {
      return str.replace(/[&<>'"]/g, function (tag) {
        const charsToReplace = {
          '&': '&amp;',
          '<': '&lt;',
          '>': '&gt;',
          "'": '&#39;',
          '"': '&quot;'
        };
        return charsToReplace[tag] || tag;
      });
    }

    function flashError(msg) {
      // simple in-DOM toast-like message
      let toast = document.getElementById('__toast');
      if (!toast) {
        toast = document.createElement('div');
        toast.id = '__toast';
        toast.style.position = 'fixed';
        toast.style.right = '20px';
        toast.style.bottom = '20px';
        toast.style.padding = '12px 16px';
        toast.style.background = 'linear-gradient(90deg,#ff6b6b,#ff875f)';
        toast.style.color = 'white';
        toast.style.borderRadius = '10px';
        toast.style.boxShadow = '0 8px 28px rgba(0,0,0,0.12)';
        toast.style.zIndex = 9999;
        document.body.appendChild(toast);
      }
      toast.textContent = msg;
      toast.style.opacity = '1';
      clearTimeout(toast.__t);
      toast.__t = setTimeout(() => {
        toast.style.opacity = '0';
      }, 2500);
    }

    /***************
     * Logout behavior (keeps your original alert + reload)
     ***************/
    function logout(evt) {
      evt && evt.preventDefault();
      // small confirmation
      if (confirm('You will be logged out. Continue?')) {
        // simulate redirect to auth page (preserve your original link)
        window.location.href = 'auth.html';
      }
    }

    // initial KPI update
    updateKPIs();

    // keep keyboard accessibility for hamburger (Enter toggles)
    hambBtn.addEventListener('keydown', function(e){
      if (e.key === 'Enter' || e.key === ' ') toggleSidebar();
    });

  </script>
</body>
</html>
